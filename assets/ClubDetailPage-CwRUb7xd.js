import{e as k,r as o,u as b,j as t,c as u,f as E,b as I,a as S}from"./index-idLZ2ra4.js";import{H as L}from"./Header-DCXPCf8e.js";import{T}from"./Chip_type-CDyWHx2q.js";import{S as D,a as U}from"./icn_sns_insta-BJJGLCzu.js";import{u as p}from"./useQuery-BQXZuXjs.js";import{P as $}from"./Chip_period-zLzT1xlI.js";import{D as M}from"./Default_images-B5G-Vn7S.js";import{f as P}from"./date-B0GoYsVM.js";import{P as w}from"./PrimaryBtn-DnTa1aLB.js";import"./icn_search_24-2-D-2_nUOd.js";import"./ic_arrow_left_24-DEh5BAMN.js";var R=k();const q=e=>o.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.createElement("path",{d:"M8.13647 1.15906C10.3302 1.15906 13.2466 2.71717 13.2468 6.76648C13.2468 10.4981 10.5599 12.9439 8.60913 14.4159C8.26177 14.6779 7.78191 14.673 7.43823 14.4061C5.5402 12.9324 2.75366 10.4197 2.75366 6.76648C2.75386 2.71726 5.94274 1.15915 8.13647 1.15906ZM7.99976 4.70203C6.97282 4.70216 6.14038 5.53541 6.14038 6.56238C6.1405 7.58924 6.97289 8.42162 7.99976 8.42175C9.02673 8.42175 9.85998 7.58933 9.86011 6.56238C9.86011 5.53533 9.02681 4.70203 7.99976 4.70203Z",fill:"#A0AAB0"})),B=e=>o.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.createElement("circle",{cx:7.99967,cy:5.07181,r:3.47757,fill:"#A0AAB0"}),o.createElement("path",{d:"M2.49477 13.7423C2.7214 11.0325 4.34699 8.12549 7.94188 8.12549C11.5368 8.12549 13.2609 11.0326 13.5025 13.7424C13.5351 14.1083 13.2345 14.4063 12.8672 14.4063H3.13194C2.76467 14.4063 2.46416 14.1083 2.49477 13.7423Z",fill:"#A0AAB0"})),F=e=>o.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},o.createElement("path",{d:"M17.54 4.90975C17.315 4.68468 17.0479 4.50615 16.754 4.38436C16.46 4.26258 16.1449 4.19994 15.8266 4.20001C15.5084 4.20009 15.1933 4.26288 14.8994 4.3848C14.6055 4.50672 14.3384 4.68537 14.1136 4.91055L6.508 12.5266C6.05483 12.9808 5.80023 13.5961 5.8 14.2378V16.8002C5.8 17.1314 6.0688 17.4002 6.4 17.4002H8.9784C9.6208 17.4002 10.2368 17.1442 10.6904 16.6906L18.2904 9.08575C18.7438 8.63133 18.9983 8.01565 18.9983 7.37375C18.9983 6.73186 18.7438 6.11618 18.2904 5.66175L17.54 4.90975ZM5.6 18.6002C5.44087 18.6002 5.28826 18.6634 5.17574 18.7759C5.06321 18.8884 5 19.041 5 19.2002C5 19.3593 5.06321 19.5119 5.17574 19.6244C5.28826 19.7369 5.44087 19.8002 5.6 19.8002H18.4C18.5591 19.8002 18.7117 19.7369 18.8243 19.6244C18.9368 19.5119 19 19.3593 19 19.2002C19 19.041 18.9368 18.8884 18.8243 18.7759C18.7117 18.6634 18.5591 18.6002 18.4 18.6002H5.6Z",fill:"#A0AAB0"})),H=({club:e,isAdmin:r=!1})=>{const s=b();return e?t.jsxs("section",{className:"px-4 pt-6 pb-4 bg-white",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("img",{src:e.profileImageUrl||"/OnlyLogo.svg",alt:"club logo",className:"w-[64px] h-[64px] rounded-full border border-gray-100 object-cover"}),t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx(T,{size:"medium",children:e.clubType}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("p",{className:"text-[18px] font-semibold text-gray-900 leading-[135%] tracking-[-0.03em]",children:e.clubName}),r&&t.jsx("button",{onClick:()=>s(`/admin/clubs/${e.clubId}/edit`),className:"p-1","aria-label":"동아리 정보 수정",children:t.jsx(F,{width:24,height:24,className:"text-gray-400"})})]})]})]}),t.jsxs("div",{className:"mt-4 space-y-2",children:[e.location&&t.jsx(j,{icon:t.jsx(q,{}),label:"동아리 방",value:e.location}),e.details&&t.jsx(j,{icon:t.jsx(B,{}),label:"모집 대상",value:e.details}),t.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[t.jsx("span",{className:"text-[14px] font-medium leading-[135%] tracking-[-0.03em] text-gray-600",children:"SNS"}),e.clubUrl&&t.jsx("a",{href:e.clubUrl,target:"_blank",rel:"noopener noreferrer",children:t.jsx(D,{})}),e.instagramUrl&&t.jsx("a",{href:e.instagramUrl,target:"_blank",rel:"noopener noreferrer",children:t.jsx(U,{})})]})]})]}):null},j=({icon:e,label:r,value:s})=>t.jsxs("div",{className:"flex items-center gap-2",children:[e,t.jsx("span",{className:"text-[14px] font-medium leading-[135%] tracking-[-0.03em] text-gray-600",children:r}),t.jsx("span",{className:"text-[14px] font-medium leading-[135%] tracking-[-0.03em] text-gray-400",children:s})]}),z=({defaultTab:e="모집공고",onTabChange:r})=>{const[s,a]=o.useState(e),c=i=>{a(i),r(i)};return t.jsx("div",{className:"flex w-full border-b border-gray-100",children:["모집공고","동아리 소개"].map(i=>t.jsx("button",{onClick:()=>c(i),className:`flex-1 text-center py-3 text-[16px] font-semibold leading-[135%] tracking-[-0.03em]
            ${s===i?"text-gray-900":"text-gray-300"}
          `,children:i},i))})},K=async e=>{try{return(await u.get(`/api/recruitments/${e}/images`)).data}catch{return[]}},Z=({recruitmentId:e,recruitmentStatus:r,dDay:s,title:a,viewCount:c,saveCount:i,postedDate:n})=>{const{data:l}=p({queryKey:["recruitmentThumbnail",e],queryFn:()=>K(e),staleTime:1/0}),d=l?.[0]||M;return t.jsxs("div",{className:"flex w-full bg-white p-4 gap-3 border-b border-gray-100",children:[t.jsx("img",{src:d,alt:`${a} thumbnail`,className:"w-[100px] h-[100px] object-cover rounded-[10px] border border-gray-100 flex-shrink-0",loading:"lazy",decoding:"async"}),t.jsxs("div",{className:"flex flex-col flex-grow justify-between",children:[t.jsxs("div",{children:[t.jsx($,{status:r,dDay:s,size:"medium"}),t.jsx("p",{className:"mt-1 text-base font-medium text-gray-900 leading-[1.35] tracking-[-0.03em]",children:a})]}),t.jsxs("div",{className:"flex justify-between items-center text-xs font-normal text-gray-300 leading-[1.4] tracking-[-0.02em]",children:[t.jsxs("div",{className:"flex gap-2",children:[c!==void 0&&t.jsxs("span",{children:["조회 ",c]}),t.jsxs("span",{children:["저장 ",i]})]}),t.jsx("span",{children:n})]})]})]})},_=async e=>{const r=await u.get(`/api/recruitments/club/${e}`);if(r.data.status!==200)throw new Error(r.data.message);return Array.isArray(r.data.data)?r.data.data:[]},C=e=>{if(!e)return 0;const r=new Date,s=new Date(e);r.setHours(0,0,0,0),s.setHours(0,0,0,0);const a=s.getTime()-r.getTime(),c=Math.ceil(a/(1e3*60*60*24));return c<0?0:c},W=(e,r)=>{if(!r)return"regular";const s=C(r);return s===0?"end":s<=7?"d-day":"regular"},O=e=>{const{data:r,isLoading:s,isError:a,error:c}=p({queryKey:["recruitmentDetail",e],queryFn:async()=>{if(!e)return null;const i=await _(e);return!i||i.length===0?[]:i.map(n=>({recruitmentId:n.id,clubId:n.clubId,clubName:n.clubName,title:n.title,description:n.description,type:n.type,phoneNumber:n.phoneNumber,email:n.email,startDate:n.startDate,endDate:n.endDate,createdAt:n.createdAt,url:n.url,images:[],status:W(n.type,n.endDate),dDay:C(n.endDate),viewCount:n.viewCount||0,scrapCount:n.saveCount||0,isScrapped:!1}))},enabled:!!e});return{data:r,isLoading:s,isError:a,error:c}},Q=({clubId:e,isAdmin:r=!1})=>{const s=b(),{data:a,isLoading:c,error:i}=O(e),n=[...a??[]].sort((l,d)=>new Date(d.createdAt).getTime()-new Date(l.createdAt).getTime());return c?t.jsx("p",{className:"p-4 text-center",children:"로딩 중..."}):i?t.jsx("p",{className:"p-4 text-center text-red-500",children:"모집 공고를 불러오는 중 오류가 발생했습니다."}):t.jsxs("div",{className:"flex flex-col",children:[r&&t.jsx("div",{className:"px-4 py-4 border-b border-gray-100",children:t.jsx(w,{isActive:!0,onClick:()=>s(`/admin/clubs/${e}/recruitments/new`),className:"w-full",children:"공고 작성하기"})}),t.jsx("div",{className:"divide-y divide-gray-100",children:n.length===0?t.jsx("div",{className:"py-10 text-center text-gray-300 text-base font-medium leading-[1.35] tracking-[-0.03em]",children:"등록된 모집 공고가 없습니다."}):n.map(l=>t.jsx("div",{onClick:()=>s(`/recruitments/${l.recruitmentId}`),className:"cursor-pointer",children:t.jsx(Z,{recruitmentId:l.recruitmentId,recruitmentStatus:l.status,dDay:l.dDay,title:l.title,saveCount:l.scrapCount,postedDate:P(l.createdAt)})},l.recruitmentId))})]})},V=({isOpen:e,onClose:r,children:s})=>(o.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[e]),o.useEffect(()=>{const a=c=>{c.key==="Escape"&&r()};return e&&document.addEventListener("keydown",a),()=>{document.removeEventListener("keydown",a)}},[e,r]),e?R.createPortal(t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",onClick:r,children:t.jsx("div",{className:"relative w-full h-full",onClick:a=>a.stopPropagation(),children:s})}),document.body):null);function X({title:e,titleId:r,...s},a){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":r},s),e?o.createElement("title",{id:r},e):null,o.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const G=o.forwardRef(X),y=({title:e})=>t.jsx("h3",{className:"text-[14px] font-semibold text-gray-800 leading-[1.35] tracking-[-0.03em] mb-3",children:e}),v=({content:e})=>{if(!e)return t.jsx("p",{className:"text-[16px] font-medium text-gray-300 leading-[1.65] tracking-[-0.03em]",children:"등록된 내용이 없습니다."});const r=e.replace(/\\n/g,`
`);return t.jsx("p",{className:"text-[16px] font-medium text-gray-700 leading-[1.65] tracking-[-0.03em] whitespace-pre-wrap",children:r})},J=({club:e,activityImages:r,isAdmin:s=!1})=>{const a=b(),c=r?r.filter(m=>!!m):[],[i,n]=o.useState(!1),[l,d]=o.useState(null),h=m=>{d(m),n(!0)},x=()=>{n(!1),d(null)};return t.jsxs("div",{className:"bg-gray-50 p-4 space-y-6 pb-24",children:[t.jsxs("section",{children:[t.jsx(y,{title:"동아리 설명"}),t.jsx(v,{content:e.description})]}),t.jsxs("section",{children:[t.jsx(y,{title:"주요 활동"}),t.jsx(v,{content:e.mainActivities})]}),t.jsxs("section",{children:[t.jsx(y,{title:"활동 사진"}),c.length>0?t.jsx("div",{className:"space-y-4",children:c.map((m,g)=>t.jsx("img",{src:m,alt:`활동 사진 ${g+1}`,className:"w-full h-auto rounded-lg object-cover border border-gray-100 cursor-pointer",onClick:()=>h(m),loading:"lazy",decoding:"async"},g))}):t.jsx("p",{className:"text-[16px] font-medium text-gray-300 leading-[1.65] tracking-[-0.03em]",children:"등록된 사진이 없습니다."})]}),s&&t.jsx("div",{className:"mt-8",children:t.jsx(w,{isActive:!0,onClick:()=>a(`/admin/clubs/${e.clubId}/intro/edit`),className:"w-full",children:"소개 수정하기"})}),i&&l&&t.jsx(V,{isOpen:i,onClose:x,children:t.jsxs("div",{className:"relative w-full h-full flex items-center justify-center p-4",children:[t.jsx("button",{onClick:x,className:"absolute top-4 right-4 text-white hover:text-gray-300 z-50 p-2 bg-black/50 rounded-full",children:t.jsx(G,{className:"h-6 w-6"})}),t.jsx("img",{src:l,alt:"확대된 활동 사진",className:"max-w-full max-h-full object-contain"})]})})]})},f=e=>({clubId:e.id,clubName:e.name,description:e.description,mainActivities:e.mainActivities||null,location:e.location||null,contactPhoneNumber:e.contactPhoneNumber||null,instagramUrl:e.instagramUrl||null,youtubeUrl:e.youtubeUrl||null,linktreeUrl:e.linktreeUrl||null,clubUrl:e.clubUrl||null,contactEmail:e.contactEmail||null,createdAt:e.createdAt||"",updatedAt:e.updatedAt||"",clubType:e.clubType,profileImageUrl:e.logoUrl,category:e.category,details:e.details||null,isRecruiting:e.recruiting}),Y=async(e,r)=>{if(r==="중앙동아리"){const s=await u.get(`/api/club/central/${e}`);if(s.data.status===200)return f(s.data.data);throw new Error(s.data.message||"Failed to fetch central club details")}if(r==="소학회"){const s=await u.get(`/api/club/academic/${e}`);if(s.data.status===200)return f(s.data.data);throw new Error(s.data.message||"Failed to fetch academic club details")}try{const s=await u.get(`/api/club/central/${e}`);if(s.data.status===200)return f(s.data.data)}catch(s){if(s.response&&s.response.status===404)try{const a=await u.get(`/api/club/academic/${e}`);if(a.data.status===200)return f(a.data.data)}catch(a){throw console.error("Academic club fetch failed:",a),a}throw console.error("Central club fetch failed:",s),s}throw new Error("Failed to fetch club details")},ee=(e,r)=>p({queryKey:["clubDetail",e,r],queryFn:()=>Y(e,r),enabled:!!e,retry:!1}),te=async e=>{try{const r=await u.get(`/api/club/${e}/activity-images`);return r.data.status===200&&Array.isArray(r.data.data)?r.data.data.map(s=>s.imageUrl):(console.warn("Activity images data is not an array:",r.data.data),[])}catch(r){return r.response?.status!==404&&console.error("Error fetching activity images:",r),[]}},re=e=>p({queryKey:["clubActivityImages",e],queryFn:()=>te(e),enabled:!!e}),fe=()=>{const{clubId:e}=E(),r=I(),[s,a]=o.useState("모집공고"),c=S(A=>A.user),i=Number(e),n=r.state?.clubType,l=!!(c&&c.managedClubIds?.includes(i));if(!i)return t.jsx("div",{className:"p-4 text-red-500",children:"유효하지 않은 접근입니다."});const{data:d,isLoading:h,isError:x,error:m}=ee(i,n),{data:g,isLoading:N}=re(i);return h||N?t.jsx("div",{className:"p-4 text-center",children:"로딩 중..."}):x||!d?t.jsxs("div",{className:"p-4 text-center text-red-500",children:["동아리 정보를 불러오지 못했습니다. (",m?.message,")"]}):t.jsxs("div",{className:"min-h-screen bg-white",children:[t.jsx(L,{variant:"page"}),t.jsx(H,{club:d,isAdmin:l}),t.jsx(z,{onTabChange:a}),s==="모집공고"?t.jsx(Q,{clubId:i,isAdmin:l}):t.jsx(J,{club:d,activityImages:g,isAdmin:l})]})};export{fe as default};
